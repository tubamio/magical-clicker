<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>魔法少女インフレクリッカー (UI scaffold)</title>
<style>
  :root{
    --bg:#0f0d1a; --panel:#1a1730; --panel-2:#221e3c; --border:#2c2950;
    --text:#f0ecff; --muted:#bfb7e8; --primary:#3ea0ff; --primary-2:#56c7ff;
    --accent:#ffd479; --good:#22c55e; --warn:#f59e0b; --danger:#ef4444;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:radial-gradient(1200px 800px at 20% 0%,#1b1536 0%,#0f0d1a 60%),var(--bg);color:var(--text);font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif}
  a{color:var(--primary)}
  .container{max-width:1200px;margin:24px auto;padding:0 16px;display:grid;grid-template-columns:1.6fr .9fr;gap:16px}
  header.title{grid-column:1 / span 2;display:flex;align-items:center;gap:12px}
  header.title h1{margin:0;font-size:22px}
  .badge{font-size:12px;color:#bdb7e7;background:rgba(255,255,255,.06);padding:2px 8px;border-radius:999px;border:1px solid var(--border)}
  .panel{background:linear-gradient(180deg,var(--panel),var(--panel-2));border:1px solid var(--border);border-radius:14px;box-shadow:0 8px 24px rgba(0,0,0,.35);overflow:hidden}
  .panel .hd{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:1px solid var(--border);background:rgba(255,255,255,.02)}
  .panel .bd{padding:16px}
  .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  .col{display:flex;flex-direction:column;gap:12px}
  .btn{background:var(--primary);color:white;border:none;border-radius:10px;padding:10px 14px;cursor:pointer;font-weight:600}
  .btn:hover{filter:brightness(1.06)}
  .btn.ghost{background:transparent;border:1px solid var(--border);color:var(--text)}
  .btn.good{background:var(--good)} .btn.warn{background:var(--warn)} .btn.danger{background:var(--danger)}
  .stat{display:flex;gap:8px;align-items:baseline}
  .stat .big{font-size:30px;font-weight:800;letter-spacing:.5px}
  .muted{color:var(--muted)}
  .pill{background:rgba(255,255,255,.07);border:1px solid var(--border);padding:6px 10px;border-radius:999px}
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .grid3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
  .genlist{display:flex;flex-direction:column;gap:10px}
  .gen{display:grid;grid-template-columns:1fr 340px;gap:12px;padding:12px;border:1px solid var(--border);border-radius:12px;background:rgba(255,255,255,.03)}
  .gen .name{font-weight:800;margin-bottom:4px}
  .gen .desc{font-size:12px;color:var(--muted)}
  .right{display:flex;flex-direction:column;gap:8px;min-width:280px}
  .right .grid2{grid-template-columns:1fr 1fr}
  .right .panel .bd{display:flex;flex-direction:column;gap:12px}
  .select{background:transparent;color:var(--text);border:1px solid var(--border);border-radius:8px;padding:8px 10px}
  footer{grid-column:1 / span 2;color:var(--muted);text-align:center;padding:12px}
  .kpi{display:flex;gap:14px;align-items:center}
  .tap{background:linear-gradient(180deg,#2a49ff,#2b2db5);border:1px solid #2f3fdb;border-radius:12px;padding:14px 16px;text-align:center;color:white;font-weight:800}
  .tap .big{font-size:22px}
  .box{border:1px solid var(--border);border-radius:12px;padding:12px;background:rgba(255,255,255,.02)}
</style>
</head>
<body>
  <div class="container">
    <header class="title">
      <h1>魔法少女インフレクリッカー</h1>
      <span class="badge">v0.1.8.5</span>
      <div style="flex:1"></div>
      <label class="row">表記
        <select id="notation" class="select">
          <option>日本式</option><option>英式</option><option>科学</option>
        </select>
      </label>
    </header>

    <!-- Left/Main -->
    <div class="col">
      <div class="panel">
        <div class="hd"><strong>威力</strong><span class="muted">（仮）</span></div>
        <div class="bd">
          <div class="kpi">
            <div class="stat"><span class="big" id="power">0</span></div>
            <div class="pill">生成/秒: <span id="pps">0</span></div>
          </div>
          <div class="tap" style="margin-top:12px">
            <div>タップ: <span class="big" id="tapGain">+1.0</span></div>
            <div class="row" style="justify-content:center;margin-top:8px">
              <button id="tapBtn" class="btn">タップ！</button>
              <button id="upgradeClick" class="btn warn">強化 +1</button>
              <span class="pill muted" id="clickInfo">クリック強化 Lv 0 / 次: +?（費用 ?）</span>
            </div>
          </div>
        </div>
      </div>

      <div class="panel">
        <div class="hd"><strong>仲間（ジェネレーター）</strong>
          <div class="row">
            <label>購入数:
              <select id="buyMode" class="select"><option value="1">1</option><option value="10">10</option><option value="max">Max</option></select>
            </label>
          </div>
        </div>
        <div class="bd">
          <div class="genlist" id="genlist"></div>
        </div>
      </div>
    </div>

    <!-- Right/Sidebar -->
    <div class="right">
      <div class="panel">
        <div class="hd"><strong>変身（転生）</strong></div>
        <div class="bd">
          <div class="box muted">所持：<span id="prestigeCurr">0</span></div>
          <div class="grid2">
            <button class="btn ghost" data-rank="1">L1 ピュアハート<br><span class="muted small">獲得見込み: +0.00</span></button>
            <button class="btn ghost" data-rank="2">L2 魔装<br><span class="muted small">獲得見込み: +0.00</span></button>
            <button class="btn ghost" data-rank="3">L3 霊章<br><span class="muted small">獲得見込み: +0.00</span></button>
            <button class="btn ghost" data-rank="4">L4 星環<br><span class="muted small">獲得見込み: +0.00</span></button>
            <button class="btn ghost" data-rank="5">L5 永輝<br><span class="muted small">獲得見込み: +0.00</span></button>
          </div>
        </div>
      </div>

      <div class="panel">
        <div class="hd"><strong>システム</strong></div>
        <div class="bd">
          <div class="row">
            <button id="saveBtn" class="btn good">保存</button>
            <button id="loadBtn" class="btn ghost">読込</button>
            <button id="resetBtn" class="btn danger" style="margin-left:auto">ハードリセット</button>
          </div>
        </div>
      </div>
    </div>

    <footer>UI雛形（JS一体型）。見た目をTS版に寄せた構成。次にロジックを段階的に移植します。</footer>
  </div>

<script>
// ---- Minimal placeholder logic (UI反応だけ) ----
const state = {
  power: 0,
  tapLevel: 0,
  tapBase: 1,
  score: 0,
  mult: { pps: 1, click: 1 },
  gens: [
    { id:'familiar', name:'見習いの妖', count:15, basePps:1.55, baseCost:81.4, costMul:1.15, level:15 },
    { id:'orb', name:'使い魔オーブ', count:8, basePps:14.0, baseCost:393, costMul:1.17, level:8 },
    { id:'collector', name:'星屑蒐集器', count:0, basePps:170, baseCost:1800, costMul:1.20, level:0 },
    { id:'lens', name:'月光レンズ', count:0, basePps:2546, baseCost:208000, costMul:1.22, level:0 },
    { id:'arc', name:'虹色ループ', count:0, basePps:3.7e7, baseCost:5.2e9, costMul:1.25, level:0 },
  ],
};

const $ = (q)=>document.querySelector(q);
const fmt = (n)=>{
  if(!Number.isFinite(n)) return '∞';
  const a=Math.abs(n);
  if(a<1e6){ return (a>=1000? Math.round(n).toLocaleString('en-US'): (a>=100? n.toFixed(0): a>=10? n.toFixed(1): n.toFixed(2))); }
  const e=Math.floor(Math.log10(a)), m=a/10**e;
  return (n<0?'-':'')+m.toFixed(2)+'e'+e;
};

function nextCost(gen, add=1){
  const c0 = gen.baseCost * Math.pow(gen.costMul, gen.count);
  return c0 * (Math.pow(gen.costMul, add)-1)/(gen.costMul-1);
}
function powerFor(gen){
  const linear = Math.pow(1.10, gen.level|0);
  const step = Math.pow(2, Math.floor((gen.level|0)/10));
  return gen.basePps * linear * step;
}
function pps(){
  return state.gens.reduce((p,g)=> p + g.count * powerFor(g), 0) * state.mult.pps;
}
function tapGain(){ return state.tapBase * Math.pow(1.2, state.tapLevel) * state.mult.click; }

function renderClickArea(){
  $('#tapGain').textContent = '+'+fmt(tapGain());
  $('#clickInfo').textContent = `クリック強化 Lv ${state.tapLevel} / 次: +${fmt(tapGain()*0.2)}（費用 ${fmt((state.tapLevel+1)*1500)}）`;
}
function renderKPI(){
  $('#power').textContent = fmt(state.power);
  $('#pps').textContent = fmt(pps());
}
function genRow(g){
  const wrap = document.createElement('div');
  wrap.className = 'gen';
  wrap.innerHTML = `
    <div class="left">
      <div class="name">${g.name} <span class="muted">x${g.count}</span></div>
      <div class="desc">単体/sec: ${fmt(powerFor(g))}　最大強化後: ${fmt(g.basePps)} ×(1.1^Lv)×(2^⌊Lv/10⌋)</div>
    </div>
    <div class="right">
      <div class="grid2">
        <button class="btn good buy1">購入 1（${fmt(nextCost(g,1))}）</button>
        <button class="btn good buymax">最大購入 ×?（${fmt(nextCost(g,5))}）</button>
      </div>
      <div class="grid2">
        <button class="btn warn up1">強化 +1（${fmt(300+g.level*48)}）</button>
        <button class="btn warn upmax">最大強化 ×?（-${g.level}）</button>
      </div>
    </div>`;
  // wire minimal handlers (ダミー動作)
  wrap.querySelector('.buy1').addEventListener('click', ()=>{ g.count+=1; renderAll(); });
  wrap.querySelector('.buymax').addEventListener('click', ()=>{ g.count+=5; renderAll(); });
  wrap.querySelector('.up1').addEventListener('click', ()=>{ g.level+=1; renderAll(); });
  wrap.querySelector('.upmax').addEventListener('click', ()=>{ g.level+=10; renderAll(); });
  return wrap;
}
function renderGens(){
  const list = $('#genlist'); list.innerHTML='';
  state.gens.forEach(g=> list.appendChild(genRow(g)));
}

function renderAll(){ renderClickArea(); renderKPI(); renderGens(); }
renderAll();

// ---- UI actions ----
$('#tapBtn').addEventListener('click', ()=>{ state.power += tapGain(); renderKPI(); });
$('#upgradeClick').addEventListener('click', ()=>{ state.tapLevel += 1; renderClickArea(); });

// system buttons (ダミー)
$('#saveBtn').addEventListener('click', ()=> alert('保存（ダミー）'));
$('#loadBtn').addEventListener('click', ()=> alert('読込（ダミー）'));
$('#resetBtn').addEventListener('click', ()=>{ if(confirm('ハードリセットしますか？')) location.reload(); });
</script>
</body>
</html>
